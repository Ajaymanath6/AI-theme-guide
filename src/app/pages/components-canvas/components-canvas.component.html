<div class="min-h-screen bg-brandcolor-fill p-4">
  <!-- Top Controls Bar -->
  <div class="mb-4 flex justify-between items-center">
    <!-- Zoom Controls (LEFT) -->
    <div class="flex items-center gap-2 bg-white rounded-lg shadow-md px-3 py-2 border border-brandcolor-strokeweak">
      <button (click)="zoomOut()"
              class="p-1 text-brandcolor-textstrong hover:text-brandcolor-primary hover:bg-brandcolor-fill rounded transition-colors"
              title="Zoom Out (Ctrl + -)">
        <span class="material-symbols-outlined" style="font-size: 20px;">remove</span>
      </button>
      
      <span class="text-sm font-medium text-brandcolor-textstrong min-w-[50px] text-center">
        {{ getZoomPercentage() }}%
      </span>
      
      <button (click)="zoomIn()"
              class="p-1 text-brandcolor-textstrong hover:text-brandcolor-primary hover:bg-brandcolor-fill rounded transition-colors"
              title="Zoom In (Ctrl + +)">
        <span class="material-symbols-outlined" style="font-size: 20px;">add</span>
      </button>
      
      <div class="w-px h-6 bg-brandcolor-strokeweak mx-1"></div>
      
      <button (click)="resetZoom()"
              class="p-1 text-brandcolor-textstrong hover:text-brandcolor-primary hover:bg-brandcolor-fill rounded transition-colors"
              title="Reset View (Ctrl + 0)">
        <span class="material-symbols-outlined" style="font-size: 20px;">center_focus_strong</span>
      </button>
    </div>
    
    <!-- Save to Project Button (RIGHT) -->
    <button (click)="exportCatalog()"
            class="flex items-center gap-2 px-4 py-2 bg-brandcolor-primary text-white rounded-lg hover:bg-brandcolor-primaryhover transition-colors shadow-md"
            title="ðŸ’¡ Saves directly to your project folder (first time: select folder)">
      <span class="material-symbols-outlined" style="font-size: 20px;">save</span>
      <span class="text-sm font-medium">Save to Project</span>
    </button>
  </div>
  
  <!-- Canvas Area -->
  <div class="relative bg-brandcolor-white border border-brandcolor-strokeweak rounded-lg overflow-hidden canvas-container h-[calc(100vh-2rem)]"
       (mousedown)="onCanvasMouseDown($event)"
       (mousemove)="onCanvasMouseMove($event)"
       (mouseup)="onCanvasMouseUp($event)"
       (mouseleave)="onCanvasMouseUp($event)"
       (wheel)="onCanvasWheel($event)">
    
    <!-- Canvas Viewport (pan & zoom wrapper) -->
    <div class="canvas-viewport absolute inset-0 w-full h-full"
         [style.transform]="getCanvasTransform()"
         [style.transform-origin]="'0 0'"
         [style.cursor]="isPanning ? 'grabbing' : 'grab'">
      
      <!-- Canvas Elements -->
      @for (element of canvasElements; track element.id) {
        <div
          cdkDrag
          [attr.data-element-id]="element.id"
          (cdkDragStarted)="onDragStarted(element)"
          (cdkDragMoved)="onDragMoved($event, element)"
          (cdkDragEnded)="onDragEnded($event, element)"
          [style.position]="'absolute'"
          [style.left.px]="element.x"
          [style.top.px]="element.y"
          [style.cursor]="'move'"
          [style.z-index]="'1'"
          class="cursor-move draggable-element component-wrapper"
          [class.shared-component]="element.isSharedComponent"
          [class.super-component]="isSuperComponent(element.type)"
          [cdkDragDisabled]="false">
          
          <!-- Header Component -->
          @if (element.type === 'header') {
            <header class="bg-brandcolor-textstrong border-b border-brandcolor-strokeweak rounded-lg shadow-lg">
              <div class="flex items-center justify-between px-4 py-[14px] min-w-[600px]">
                <!-- Logo -->
                <a routerLink="/projects" class="flex items-center cursor-pointer">
                  <img src="/logo-main.svg" alt="Logo" class="h-8">
                </a>

                <!-- Right Side Options -->
                <div class="flex items-center gap-4">
                  <!-- Option 1 -->
                  <button
                    type="button"
                    class="flex items-center gap-2 px-3 py-2 text-brandcolor-white hover:bg-brandcolor-sidebarhover rounded-lg transition-colors">
                    <span class="material-symbols-outlined" style="font-size: 20px;">settings</span>
                    <span class="text-sm font-medium">Settings</span>
                  </button>

                  <!-- Option 2 -->
                  <button
                    type="button"
                    class="flex items-center gap-2 px-3 py-2 text-brandcolor-white hover:bg-brandcolor-sidebarhover rounded-lg transition-colors">
                    <span class="material-symbols-outlined" style="font-size: 20px;">help_outline</span>
                    <span class="text-sm font-medium">Help</span>
                  </button>
                </div>
              </div>
            </header>
          }
          
          <!-- Primary Button Component -->
          @if (element.type === 'primary-button') {
            <!-- Always show HTML on canvas for visual reference -->
            <button
              type="button"
              class="border-[1.5px] border-transparent bg-brandcolor-primary text-brandcolor-white hover:bg-brandcolor-primaryhover focus:border-brandcolor-primary active:border-brandcolor-primary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium shadow-lg">
              Primary
            </button>
          }
          
          <!-- Primary Outline Button Component -->
          @if (element.type === 'primary-outline-button') {
            <!-- Always show HTML on canvas for visual reference -->
            <button
              type="button"
              class="border-[1.5px] border-brandcolor-strokelight text-brandcolor-primary bg-brandcolor-white hover:bg-brandcolor-neutralhover active:border-brandcolor-primary active:text-brandcolor-primary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium">
              Primary Outline
            </button>
          }
          
          <!-- Secondary Button Component -->
          @if (element.type === 'secondary-button') {
            <!-- Always show HTML on canvas for visual reference -->
            <button
              type="button"
              class="border-[1.5px] border-transparent bg-brandcolor-secondary text-brandcolor-white hover:bg-brandcolor-secondaryhover focus:border-brandcolor-secondary active:border-brandcolor-secondary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium shadow-lg">
              Secondary
            </button>
          }
          
          <!-- Secondary Outline Button Component -->
          @if (element.type === 'secondary-outline-button') {
            <!-- Always show HTML on canvas for visual reference -->
            <button
              type="button"
              class="border-[1.5px] border-brandcolor-strokelight text-brandcolor-secondary bg-brandcolor-white hover:bg-brandcolor-neutralhover active:border-brandcolor-secondary active:text-brandcolor-secondary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium">
              Secondary Outline
            </button>
          }
          
          <!-- Super Component Rendering -->
          @if (isSuperComponent(element.type)) {
            @switch (element.type) {
              @case ('super-component') {
                <app-super-component></app-super-component>
              }
              @case ('secondary-button-variants') {
                
              }
              @default {
                <!-- Fallback: Show component info card for unknown super components -->
                <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-4 min-w-[200px]">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="material-symbols-outlined text-purple-600" style="font-size: 20px;">auto_awesome</span>
                    <span class="text-sm font-bold text-purple-700 uppercase">Super Component</span>
                  </div>
                  <div class="text-xs font-mono text-purple-600 mb-2">
                    &lt;app-{{ element.type }}&gt;
                  </div>
                  @if (getSuperComponentInfo(element.type)) {
                    <div class="text-xs text-purple-500">
                      Variants: {{ getSuperComponentInfo(element.type)?.variants?.join(', ') }}
                    </div>
                  }
                </div>
              }
            }
          }
          
          <!-- Sidebar Component -->
          @if (element.type === 'sidebar') {
            <app-sidebar
              [isSidebarCollapsed]="isSidebarCollapsed"
              [activeMenuItem]="activeMenuItem"
              [selectedDropdownOption]="selectedDropdownOption"
              [uniqueId]="element.id"
              (sidebarToggle)="toggleSidebar()"
              (menuItemClick)="onMenuItemClick($event)"
              (dropdownOptionSelect)="selectedDropdownOption = $event">
            </app-sidebar>
          }
          
          <!-- Dropdown Component: Header, 5 Options, Divider, and Two Buttons -->
          @if (element.type === 'dropdown') {
            <div class="bg-brandcolor-white border border-brandcolor-strokeweak rounded-lg p-0 w-full max-w-sm shadow-lg">
              <!-- Dropdown Button -->
              <div class="relative p-4 pb-0">
                <button 
                 
                  [id]="'dropdown-button-' + element.id" 
                  [attr.data-dropdown-toggle]="'dropdown-menu-' + element.id" 
                  type="button" 
                  class="w-full border-[1.5px] border-brandcolor-strokeweak bg-brandcolor-white text-brandcolor-textstrong hover:bg-brandcolor-fill focus:border-brandcolor-primary active:border-brandcolor-primary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium flex items-center justify-between">
                  <span>Select Option</span>
                  <svg class="w-4 h-4 text-brandcolor-strokestrong" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </button>
                <!-- Dropdown Menu -->
                <div 
                  [id]="'dropdown-menu-' + element.id" 
                  class="hidden z-50 bg-brandcolor-white border border-brandcolor-strokeweak rounded-lg shadow-lg min-w-full absolute top-12 left-4 right-4">
                  <!-- Header -->
                  <div class="px-4 py-3 border-b border-brandcolor-strokeweak">
                    <h3 class="text-brandcolor-textstrong font-semibold text-sm">Dropdown Header</h3>
                  </div>
                  <!-- Options -->
                  <ul class="py-2 text-sm text-brandcolor-textstrong">
                    <li>
                      <a href="#" (click)="onDropdownOption($event, 'option1')" class="flex items-center gap-2 px-4 py-2 hover:bg-brandcolor-fill">
                        <span>Option 1</span>
                      </a>
                    </li>
                    <li>
                      <a href="#" (click)="onDropdownOption($event, 'option2')" class="flex items-center gap-2 px-4 py-2 hover:bg-brandcolor-fill">
                        <span>Option 2</span>
                      </a>
                    </li>
                    <li>
                      <a href="#" (click)="onDropdownOption($event, 'option3')" class="flex items-center gap-2 px-4 py-2 hover:bg-brandcolor-fill">
                        <span>Option 3</span>
                      </a>
                    </li>
                    <li>
                      <a href="#" (click)="onDropdownOption($event, 'option4')" class="flex items-center gap-2 px-4 py-2 hover:bg-brandcolor-fill">
                        <span>Option 4</span>
                      </a>
                    </li>
                    <li>
                      <a href="#" (click)="onDropdownOption($event, 'option5')" class="flex items-center gap-2 px-4 py-2 hover:bg-brandcolor-fill">
                        <span>Option 5</span>
                      </a>
                    </li>
                  </ul>
                  <!-- Divider -->
                  <hr class="border-brandcolor-strokeweak">
                  <!-- Action Buttons -->
                  <div class="p-4 flex gap-3">
                    <button
                      type="button"
                     
                      (click)="onDropdownPrimaryButton(element.id)"
                      class="flex-1 border-[1.5px] border-transparent bg-brandcolor-primary text-brandcolor-white hover:bg-brandcolor-primaryhover focus:border-brandcolor-primary active:border-brandcolor-primary active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium shadow-lg">
                      Primary
                    </button>
                    <button
                      type="button"
                     
                      (click)="onDropdownNeutralButton(element.id)"
                      class="flex-1 border-[1.5px] border-brandcolor-strokeweak bg-brandcolor-white text-brandcolor-textstrong hover:bg-brandcolor-neutralhover focus:border-brandcolor-strokeweak active:border-brandcolor-strokeweak active:shadow-button-press disabled:opacity-50 rounded-md px-4 py-2 font-medium">
                      Neutral
                    </button>
                  </div>
                </div>
              </div>
            </div>
          }
          
          <!-- Universal Tooltip (works for ALL components) -->
          <div class="component-tooltip flex flex-col gap-2 bg-white/95 backdrop-blur-sm shadow-lg rounded-lg px-3 py-2 border border-gray-200">
            <!-- Row 1: Component ID with actions -->
            <div class="flex items-center gap-2">
              <span class="text-xs font-mono text-gray-700 font-medium">
                {{ element.type }}
                @if (element.isSharedComponent) {
                  <span class="ml-1 text-xs text-blue-600">(shared)</span>
                }
              </span>
              <button (click)="copyToClipboard(element.type); $event.stopPropagation()"
                      class="p-1 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition-colors"
                     >
                <span class="material-symbols-outlined" style="font-size: 18px;">content_copy</span>
              </button>
              @if (!isInCatalog(element.type)) {
                <button (click)="addToCatalog(element.type); $event.stopPropagation()"
                        class="p-1 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">add_circle_outline</span>
                </button>
              }
              @if (isInCatalog(element.type)) {
                <span class="p-1 text-green-600">
                  <span class="material-symbols-outlined" style="font-size: 18px;">check_circle</span>
                </span>
                <button (click)="removeFromCatalog(element.type); $event.stopPropagation()"
                        class="p-1 text-gray-600 hover:text-red-600 hover:bg-gray-100 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">delete_outline</span>
                </button>
              }
              @if (!element.isSharedComponent) {
                <button (click)="makeSharedComponent(element.type); $event.stopPropagation()"
                        class="p-1 text-gray-600 hover:text-blue-600 hover:bg-gray-100 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">share</span>
                </button>
              }
              @if (element.isSharedComponent) {
                <span class="p-1 text-blue-600">
                  <span class="material-symbols-outlined" style="font-size: 18px;">check_circle</span>
                </span>
              }
              <!-- Make Super Component button -->
              <button (click)="makeSuperComponent(element.type); $event.stopPropagation()"
                      class="p-1 text-gray-600 hover:text-purple-600 hover:bg-gray-100 rounded transition-colors"
                     >
                <span class="material-symbols-outlined" style="font-size: 18px;">auto_awesome</span>
              </button>
            </div>
            
            <!-- Row 2: Component tag (only for shared components) -->
            @if (element.isSharedComponent) {
              <div class="flex items-center gap-2 pt-1 border-t border-gray-200">
                <span class="text-xs font-mono text-blue-600 font-medium">
                  &lt;app-{{ element.type }}&gt;&lt;/app-{{ element.type }}&gt;
                </span>
                <button (click)="copyComponentTag(element.type); $event.stopPropagation()"
                        class="p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">content_copy</span>
                </button>
                <!-- Delete button -->
                <button (click)="deleteSharedComponent(element.type); $event.stopPropagation()"
                        class="p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">delete_forever</span>
                </button>
              </div>
            }
            
            <!-- Row 3: Super Component tag (only for super components) -->
            @if (isSuperComponent(element.type)) {
              <div class="flex items-center gap-2 pt-1 border-t border-purple-200 bg-purple-50/50 -mx-2 px-2 py-2">
                <span class="text-xs font-bold text-purple-700 uppercase tracking-wide">Super</span>
                <span class="text-xs font-mono text-purple-600 font-medium">
                  &lt;app-{{ element.type }}&gt;&lt;/app-{{ element.type }}&gt;
                </span>
                <button (click)="copyComponentTag(element.type); $event.stopPropagation()"
                        class="p-1 text-purple-600 hover:text-purple-900 hover:bg-purple-100 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">content_copy</span>
                </button>
                <!-- Delete super component button -->
                <button (click)="deleteSuperComponent(element.type); $event.stopPropagation()"
                        class="p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors"
                       >
                  <span class="material-symbols-outlined" style="font-size: 18px;">delete_forever</span>
                </button>
              </div>
              
              <!-- Variants info -->
              <div class="text-xs text-purple-600 px-2 pb-1">
                Variants: {{ getSuperComponentInfo(element.type)?.variants?.join(', ') || 'N/A' }}
              </div>
              <div class="text-xs text-purple-500 px-2 pb-2">
                Wraps: {{ getSuperComponentInfo(element.type)?.wraps?.join(', ') || 'N/A' }}
              </div>
            }
          </div>
        </div>
      }
      
      <!-- Empty Canvas Message -->
      @if (canvasElements.length === 0) {
        <div class="absolute inset-0 flex items-center justify-center">
          <p class="text-brandcolor-textweak">Drag elements around the canvas</p>
        </div>
      }
    </div>
    <!-- End Canvas Viewport -->
  </div>

  <!-- Shared Component Creation Popover -->
  @if (showSharedComponentPopover && selectedComponentForSharing) {
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center"
         (click)="cancelSharedComponentCreation()">
      <div class="bg-white rounded-lg shadow-2xl p-6 max-w-md w-full mx-4"
           (click)="$event.stopPropagation()">
        <!-- Header -->
        <div class="flex items-center gap-3 mb-4">
          <span class="material-symbols-outlined text-blue-600" style="font-size: 32px;">share</span>
          <h2 class="text-xl font-semibold text-brandcolor-textstrong">Make Shared Component</h2>
        </div>

        <!-- Component Info -->
        <div class="mb-6">
          <p class="text-brandcolor-textweak mb-3">
            Convert <span class="font-mono text-blue-600">{{ selectedComponentForSharing }}</span> into a reusable Angular component?
          </p>
          
          <!-- Files that will be created -->
          <div class="bg-brandcolor-fill rounded-lg p-4 mb-4">
            <p class="text-xs font-semibold text-brandcolor-textweak mb-2">This will create:</p>
            <ul class="space-y-1 text-sm text-brandcolor-textstrong font-mono">
              <li>âœ“ {{ selectedComponentForSharing }}.component.ts</li>
              <li>âœ“ {{ selectedComponentForSharing }}.component.html</li>
              <li>âœ“ {{ selectedComponentForSharing }}.component.scss</li>
            </ul>
          </div>

          <!-- CLI Command -->
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
            <p class="text-xs font-semibold text-blue-900 mb-2">CLI Command:</p>
            <code class="text-xs text-blue-700 font-mono break-all">
              ng generate component components/{{ selectedComponentForSharing }} --skip-tests
            </code>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex gap-3">
          <button (click)="cancelSharedComponentCreation()"
                  [disabled]="isCreatingComponent"
                  class="flex-1 px-4 py-2 border border-brandcolor-strokeweak text-brandcolor-textstrong rounded-lg hover:bg-brandcolor-fill transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
            Cancel
          </button>
          <button (click)="confirmCreateSharedComponent()"
                  [disabled]="isCreatingComponent"
                  class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
            @if (isCreatingComponent) {
              <svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span>Creating...</span>
            } @else {
              <span>Create Component</span>
            }
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Super Component Selection Dialog -->
  @if (showSuperComponentDialog) {
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center"
         (click)="cancelSuperComponentCreation()">
      <div class="bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto"
           (click)="$event.stopPropagation()">
        
        <!-- Header -->
        <div class="flex items-center gap-3 mb-4">
          <span class="material-symbols-outlined text-purple-600" style="font-size: 32px;">auto_awesome</span>
          <h2 class="text-xl font-semibold text-brandcolor-textstrong">Create Super Component</h2>
        </div>

        <!-- Super Component Name -->
        <div class="mb-4">
          <label class="block text-sm font-medium text-brandcolor-textstrong mb-2">
            Super Component Name
          </label>
          <input type="text" 
                 [(ngModel)]="superComponentName"
                 readonly
                 class="w-full px-4 py-2 border border-brandcolor-strokeweak rounded-lg bg-gray-50 font-mono text-sm">
          <p class="text-xs text-brandcolor-textweak mt-1">
            Auto-generated from selected components
          </p>
        </div>

        <!-- Approach Selection -->
        <div class="mb-4">
          <label class="block text-sm font-medium text-brandcolor-textstrong mb-2">
            Super Component Approach
          </label>
          <div class="flex gap-4">
            <label class="flex-1 flex items-start gap-2 p-3 border-2 rounded-lg cursor-pointer transition-colors"
                   [class.border-purple-600]="superComponentApproach === 'full-component'"
                   [class.bg-purple-50]="superComponentApproach === 'full-component'"
                   [class.border-brandcolor-strokeweak]="superComponentApproach !== 'full-component'"
                   [class.bg-white]="superComponentApproach !== 'full-component'">
              <input type="radio" 
                     name="superComponentApproach"
                     value="full-component"
                     [(ngModel)]="superComponentApproach"
                     class="w-4 h-4 mt-0.5">
              <div class="flex-1">
                <div class="font-semibold text-sm text-brandcolor-textstrong">Full Component Wrapping</div>
                <div class="text-xs text-brandcolor-textweak mt-1">Wraps complete Angular components (e.g., &lt;app-primary-button&gt;)</div>
              </div>
            </label>
            <label class="flex-1 flex items-start gap-2 p-3 border-2 rounded-lg cursor-pointer transition-colors"
                   [class.border-purple-600]="superComponentApproach === 'style-variation'"
                   [class.bg-purple-50]="superComponentApproach === 'style-variation'"
                   [class.border-brandcolor-strokeweak]="superComponentApproach !== 'style-variation'"
                   [class.bg-white]="superComponentApproach !== 'style-variation'">
              <input type="radio" 
                     name="superComponentApproach"
                     value="style-variation"
                     [(ngModel)]="superComponentApproach"
                     class="w-4 h-4 mt-0.5">
              <div class="flex-1">
                <div class="font-semibold text-sm text-brandcolor-textstrong">Style Variation</div>
                <div class="text-xs text-brandcolor-textweak mt-1">Single component with variant-based style switching (recommended for buttons)</div>
              </div>
            </label>
          </div>
        </div>

        <!-- Component Selection -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-brandcolor-textstrong mb-3">
            Select Components to Wrap
          </label>
          <div class="space-y-2 max-h-60 overflow-y-auto border border-brandcolor-strokeweak rounded-lg p-3">
            @if (availableSharedComponents.length === 0) {
              <div class="text-center py-8 text-brandcolor-textweak">
                <span class="material-symbols-outlined text-4xl mb-2 block">inbox</span>
                <p class="text-sm font-medium mb-1">No shared components available</p>
                <p class="text-xs">Create shared components first by clicking "Make Shared Component" on any UI element in the canvas.</p>
              </div>
            } @else {
              @for (component of availableSharedComponents; track component.id) {
                <label class="flex items-center gap-3 p-2 hover:bg-brandcolor-fill rounded cursor-pointer">
                  <input type="checkbox" 
                         [checked]="selectedComponentsForSuper.includes(component.id)"
                         (change)="toggleSuperComponentSelection(component.id)"
                         class="w-4 h-4">
                  <div class="flex-1">
                    <div class="font-mono text-sm text-brandcolor-textstrong">{{ component.id }}</div>
                    <div class="text-xs text-brandcolor-textweak">{{ component.displayName }}</div>
                  </div>
                  <span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">shared</span>
                </label>
              }
            }
          </div>
          <p class="text-xs text-brandcolor-textweak mt-2">
            Selected: {{ selectedComponentsForSuper.length }} component(s)
          </p>
        </div>

        <!-- Preview -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
          <p class="text-xs font-semibold text-blue-900 mb-2">Usage Preview:</p>
          <code class="text-xs text-blue-700 font-mono block mb-1">
            &lt;{{ superComponentName }} variant="1|2|3"&gt;&lt;/{{ superComponentName }}&gt;
          </code>
          <p class="text-xs text-blue-600 mt-2">
            @if (superComponentApproach === 'full-component') {
              Wraps: {{ selectedComponentsForSuper.join(', ') || 'None selected' }}
            } @else {
              Style variants: {{ selectedComponentsForSuper.join(', ') || 'None selected' }}
            }
          </p>
          <p class="text-xs text-purple-600 mt-1 font-medium">
            Approach: {{ superComponentApproach === 'full-component' ? 'Full Component Wrapping' : 'Style Variation' }}
          </p>
        </div>

        <!-- Actions -->
        <div class="flex gap-3 justify-end">
          <button (click)="cancelSuperComponentCreation()"
                  class="px-4 py-2 border border-brandcolor-strokeweak text-brandcolor-textstrong rounded-lg hover:bg-brandcolor-fill transition-colors">
            Cancel
          </button>
          <button (click)="confirmCreateSuperComponent()"
                  [disabled]="selectedComponentsForSuper.length < 2 || isCreatingSuperComponent"
                  class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
            @if (isCreatingSuperComponent) {
              <span>Creating...</span>
            } @else {
              <span>Create Super Component</span>
            }
          </button>
        </div>
      </div>
    </div>
  }
</div>
